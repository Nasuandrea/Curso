<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cat√°logo de Productos</title>
</head>
<body>
    <!-- T√≠tulo principal de la p√°gina -->
    <h1>üõçÔ∏è Cat√°logo de Productos</h1>
    
    <!-- Secci√≥n de filtros -->
    <div>
        <!-- Etiqueta descriptiva para el selector de categor√≠as -->
        <label for="filtroCategoria">Filtrar por categor√≠a: </label>
        
        <!-- Men√∫ desplegable para seleccionar categor√≠a. Al cambiar ejecuta filtrarProductos() -->
        <select id="filtroCategoria" onchange="filtrarProductos()">
            <option value="todos">Todos</option> <!-- Opci√≥n para mostrar todos los productos -->
            <option value="electronica">Electr√≥nica</option> <!-- Filtra solo productos de electr√≥nica -->
            <option value="ropa">Ropa</option> <!-- Filtra solo productos de ropa -->
            <option value="hogar">Hogar</option> <!-- Filtra solo productos de hogar -->
        </select>
    </div>
    
    <!-- L√≠nea separadora horizontal -->
    <hr>
    
    <!-- Contenedor donde se mostrar√°n din√°micamente todos los productos -->
    <div id="productos"></div>
    
    <!-- L√≠nea separadora horizontal -->
    <hr>
    
    <!-- T√≠tulo de la secci√≥n del carrito -->
    <h2>üõí Carrito de Compras</h2>
    
    <!-- Contenedor donde se mostrar√°n los productos agregados al carrito -->
    <div id="carrito"></div>
    
    <!-- Muestra el total a pagar -->
    <h3>Total: <span id="total">0.00</span>‚Ç¨</h3>
    
    <!-- Bot√≥n para vaciar todo el carrito. Al hacer click ejecuta vaciarCarrito() -->
    <button onclick="vaciarCarrito()">Vaciar Carrito</button>
    
    <script>
        // Array con todos los productos disponibles en la tienda
        // Cada producto tiene: id √∫nico, nombre, precio, categor√≠a y stock disponible
        const productos = [
            {id: 1, nombre: "Laptop HP", precio: 599.99, categoria: "electronica", stock: 5},
            {id: 2, nombre: "Mouse Inal√°mbrico", precio: 19.99, categoria: "electronica", stock: 15},
            {id: 3, nombre: "Teclado Mec√°nico", precio: 79.99, categoria: "electronica", stock: 8},
            {id: 4, nombre: "Camiseta B√°sica", precio: 12.99, categoria: "ropa", stock: 25},
            {id: 5, nombre: "Pantal√≥n Vaquero", precio: 39.99, categoria: "ropa", stock: 12},
            {id: 6, nombre: "Zapatillas Deportivas", precio: 65.00, categoria: "ropa", stock: 10},
            {id: 7, nombre: "L√°mpara LED", precio: 24.99, categoria: "hogar", stock: 20},
            {id: 8, nombre: "Coj√≠n Decorativo", precio: 15.50, categoria: "hogar", stock: 30},
            {id: 9, nombre: "Reloj de Pared", precio: 32.00, categoria: "hogar", stock: 7}
        ];
        
        // Array que almacena los productos que el usuario ha agregado al carrito
        // Comienza vac√≠o y se llena cuando el usuario agrega productos
        let carrito = [];
        
        // Funci√≥n que recibe una lista de productos y los muestra en la p√°gina
        function mostrarProductos(listaProductos) {
            // Obtiene el contenedor donde se mostrar√°n los productos
            const contenedor = document.getElementById('productos');
            
            // Limpia el contenedor para evitar duplicados
            contenedor.innerHTML = '';
            
            // Recorre cada producto de la lista recibida
            listaProductos.forEach(producto => {
                // Crea un nuevo elemento div para cada producto
                const div = document.createElement('div');
                
                // Aplica estilos inline al div (borde, padding, margen)
                div.style.border = '1px solid #ccc';
                div.style.padding = '10px';
                div.style.margin = '10px 0';
                
                // Inserta el HTML con la informaci√≥n del producto
                // toFixed(2) redondea el precio a 2 decimales
                // El bot√≥n tiene onclick que ejecuta agregarAlCarrito con el id del producto
                div.innerHTML = `
                    <h3>${producto.nombre}</h3>
                    <p><strong>Precio:</strong> ${producto.precio.toFixed(2)}‚Ç¨</p>
                    <p><strong>Categor√≠a:</strong> ${producto.categoria}</p>
                    <p><strong>Stock disponible:</strong> ${producto.stock} unidades</p>
                    <button onclick="agregarAlCarrito(${producto.id})">Agregar al Carrito</button>
                `;
                
                
// A√±ade el div creado al contenedor principal
// appendChild() es un m√©todo de JavaScript que se utiliza en el DOM (Document Object Model) para agregar un nuevo nodo como el √∫ltimo hijo de un elemento padre existente. Si el nodo que se intenta agregar ya tiene un padre, este m√©todo lo eliminar√° de su padre anterior y lo mover√° al nuevo elemento padre. 
                contenedor.appendChild(div);
            });
        }
        
        // Funci√≥n que filtra los productos seg√∫n la categor√≠a seleccionada
        function filtrarProductos() {
            // Obtiene el valor seleccionado en el men√∫ desplegable
            const filtro = document.getElementById('filtroCategoria').value;
            
            // Si el filtro es "todos", muestra todos los productos
            if (filtro === 'todos') {
                mostrarProductos(productos);
            } else {
                // Si no, filtra el array de productos por la categor√≠a seleccionada
                // filter() crea un nuevo array solo con los productos que cumplen la condici√≥n
                const productosFiltrados = productos.filter(p => p.categoria === filtro);
                
                // Muestra solo los productos filtrados
                mostrarProductos(productosFiltrados);
            }
        }
        
        // Funci√≥n que agrega un producto al carrito bas√°ndose en su id
        function agregarAlCarrito(id) {
            // Busca el producto en el array de productos usando su id
            // find() devuelve el primer elemento que cumple la condici√≥n
            const producto = productos.find(p => p.id === id);
            
            // Si no encuentra el producto, termina la funci√≥n
            if (!producto) return;
            
            // Busca si el producto ya existe en el carrito
            const itemCarrito = carrito.find(item => item.id === id);
            
            // Si el producto ya est√° en el carrito
            if (itemCarrito) {
                // Verifica que no se exceda el stock disponible
                if (itemCarrito.cantidad < producto.stock) {
                    // Incrementa la cantidad del producto en el carrito
                    itemCarrito.cantidad++;
                } else {
                    // Si no hay m√°s stock, muestra un mensaje de alerta
                    alert('No hay m√°s stock disponible');
                    return; // Termina la funci√≥n sin agregar m√°s
                }
            } else {
                // Si el producto no est√° en el carrito, lo agrega como nuevo item
                // push() a√±ade un elemento al final del array
                carrito.push({
                    id: producto.id,
                    nombre: producto.nombre,
                    precio: producto.precio,
                    cantidad: 1 // Inicia con cantidad 1
                });
            }
            
            // Actualiza la visualizaci√≥n del carrito
            actualizarCarrito();
        }
        
        // Funci√≥n que actualiza la vista del carrito de compras
        function actualizarCarrito() {
            // Obtiene el contenedor del carrito
            const contenedor = document.getElementById('carrito');
            
            // Limpia el contenedor
            contenedor.innerHTML = '';
            
            // Si el carrito est√° vac√≠o
            if (carrito.length === 0) {
                // Muestra mensaje de carrito vac√≠o
                contenedor.innerHTML = '<p>El carrito est√° vac√≠o</p>';
                
                // Establece el total en 0.00
                document.getElementById('total').textContent = '0.00';
                return; // Termina la funci√≥n
            }
            
            // Variable para acumular el total de la compra
            let total = 0;
            
            // Recorre cada item del carrito
            carrito.forEach(item => {
                // Crea un div para cada producto en el carrito
                const div = document.createElement('div');
                
                // Aplica estilos al div
                div.style.borderBottom = '1px solid #eee';
                div.style.padding = '5px 0';
                
                // Calcula el subtotal (precio √ó cantidad)
                const subtotal = item.precio * item.cantidad;
                
                // Suma el subtotal al total acumulado
                total += subtotal;
                
                // Inserta el HTML con la informaci√≥n del item
                // Incluye bot√≥n para eliminar con onclick que ejecuta eliminarDelCarrito
                div.innerHTML = `
                    <strong>${item.nombre}</strong> - 
                    ${item.precio.toFixed(2)}‚Ç¨ x ${item.cantidad} = 
                    ${subtotal.toFixed(2)}‚Ç¨
                    <button onclick="eliminarDelCarrito(${item.id})">Eliminar</button>
                `;
                
                // A√±ade el div al contenedor del carrito
                contenedor.appendChild(div);
            });
            
            // Actualiza el elemento que muestra el total con el valor calculado
            document.getElementById('total').textContent = total.toFixed(2);
        }
        
        // Funci√≥n que elimina un producto espec√≠fico del carrito
        function eliminarDelCarrito(id) {
            // filter() crea un nuevo array excluyendo el item con el id especificado
            // Mantiene todos los items cuyo id sea diferente al recibido
            carrito = carrito.filter(item => item.id !== id);
            
            // Actualiza la vista del carrito
            actualizarCarrito();
        }
        
        // Funci√≥n que vac√≠a completamente el carrito
        function vaciarCarrito() {
            // Verifica que el carrito tenga productos
            if (carrito.length > 0) {
                // Muestra un cuadro de confirmaci√≥n al usuario
                // confirm() devuelve true si el usuario acepta, false si cancela
                if (confirm('¬øEst√°s seguro de vaciar el carrito?')) {
                    // Vac√≠a el array del carrito asign√°ndole un array vac√≠o
                    carrito = [];
                    
                    // Actualiza la vista del carrito
                    actualizarCarrito();
                }
            }
        }
        
        // C√≥digo que se ejecuta al cargar la p√°gina
        // Muestra todos los productos inicialmente
        mostrarProductos(productos);
    </script>
</body>
</html>
